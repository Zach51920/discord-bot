services:

  postgres:
    image: postgres:latest
    container_name: postgres
    environment:
      POSTGRES_DB: discord_server_management
      POSTGRES_USER: root
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  ranna:
    image: "ghcr.io/ranna-go/ranna:latest"
    environment:
      HOSTROOTDIR: "/var/opt/ranna"
      API.MAXOUTPUTLEN: "1M"
      SANDBOX.MEMORY: "50M"
      SANDBOX.TIMEOUTSECONDS: "20"
      SANDBOX.STREAMBUFFERCAP: "1M"
    volumes:
      - "/var/run/docker.sock:/var/run/docker.sock"
      - "/var/opt/ranna:/var/opt/ranna"
    ports:
      - "8080:8000"
    restart: "on-failure"

volumes:
  postgres_data: